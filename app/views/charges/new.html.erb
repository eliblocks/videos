<script src="https://js.braintreegateway.com/web/dropin/1.3.1/js/dropin.min.js"></script>
<div class="notification is-info">
Test card number: 4111 1111 1111 1111 
</div>
<div class="columns">
  <div class="column is-6-desktop">
    <h3 class="title is-3">Buy Minutes</h3>
    <p class="sales-message">Browzable minutes allow you to view any video on the site. As you watch, minutes will be deducted from your balance. Your minutes last for a full year, so no need to plan ahead, just reload when you need. Every &cent;1 gets you 2 minutes.</p><br>
    <div id="dropin-container"></div>
    <%= button_tag "Add payment method", id: "submit-button", class: "button is-primary" %>
    <%= button_to "Pay $10", charges_path, id: "pay", class: "button is-primary", params: { nonce: "nonce"} %>
  </div>
</div>

<script>
    var button = document.querySelector('#submit-button');

    braintree.dropin.create({
      authorization: "<%= @client_token %>",
      container: '#dropin-container'
    }, function (createErr, instance) {
      button.addEventListener('click', function () {
        instance.requestPaymentMethod(function (err, payload) {
          console.log(payload);
          $("#pay").show();
          $("#submit-button").hide();
          $("input[name='nonce']").val(payload.nonce);
        });
      });
    });
  </script>